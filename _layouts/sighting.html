---
layout: default
---

{% assign poster_url = page.media-key | prepend: site.media_base_url | append: '_Thumbnail.jpg' %}
{% assign movie_url = page.media-key | prepend: site.media_base_url | append: '.mp4' %}

<main class="sighting">
  <div class="content">
    <a class="principle" href="/principles/{{ page.principle | slugify }}">{{ page.principle }}</a>
    <video controls
       src="{{ movie_url }}"
       poster="{{ poster_url }}"
       >
      <a href="{{ movie_url }}">
        <img src="{{ poster_url }}">
      </a>
    </video>
    <h1>{{ page.title }}</h1>
    {% if page.summary %}
      <div class="summary">{{ page.summary }}</div>
    {% endif %}
    {{ content }}
  </div>

  <dl class="meta">
    <dt>Principle</dt>
    <dd><a href="/principles/{{ page.principle | slugify }}">{{ page.principle }}</a></dd>
    <dt>Teaching Team</dt>
    <dd>{{ page.teaching-team }}</dd>
    <dt>Class</dt>
    <dd>{{ page.course-number }} {{ page.course-title }}</dd>
  </dl>
</main>

{% assign related = '' | split: '' %}
{% for sighting in site.sightings %}
  {% if sighting.path == page.path %}{% continue %}{% endif %}
  {% assign related = related | push: sighting %}
{% endfor %}

{% if related.size > 0 %}
  <section class="related-content same-principle">
    <h2>Related Content</h2>
    <div style="padding-left: 15px;">
      <button class="course-button" onClick="showRelated('course')">by course</button>
      <button class="principle-button" onClick="showRelated('principle')">by principle</button>
    </div>
  <div class="sightings grid">
    {% for sighting in related %}
      {% assign visibleClass = '' %}
      {% if sighting.principle != page.principle %}
        {% assign visibleClass = visibleClass | append: ' different-principle' %}
      {% endif %}
      {% if sighting.course-number != page.course-number %}
        {% assign visibleClass = visibleClass | append: ' different-course' %}
      {% endif %}
      <a class="sighting card {{ visibleClass }}" href={{ sighting.url }}>
        <div class="principle">{{ sighting.principle }}</div>
        <img src="{{ sighting.media-key | prepend: site.media_base_url | append: '_Thumbnail.jpg' }}"/>
        <h1>{{ sighting.title }}</h1>
        <div class="summary">{{ sighting.summary | default: 'TBD' }}</div>
      </a>
    {% endfor %}
    </div>
  </section>
{% endif %}

<script>
  function showRelated(sel) {
    const elt = document.querySelector('.related-content');
    elt.className = elt.className.replace(/\bsame-\w+/, ' same-' + sel);
  }
</script>
